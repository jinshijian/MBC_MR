"0","## creat function"
"0","interannual_byStudy <- function(tmin, tmax, i){"
"0","  lonterm_adj %>% gather() -> longterm_adj"
"0","  tibble(Temperature = seq(tmin,tmax,0.1), MBC = 69.901 + -3.267*Temperature) %>% "
"0","    ggplot(aes(Temperature, MBC)) +"
"0","    geom_point(alpha = 0) +"
"0","    stat_function(fun = function(x) { 69.901 + -3.267*x }, col = 'red') +"
"0","    stat_function(fun = function(x) {ifelse(x >= longterm_output$tmin[i] & x <= longterm_output$tmax[i],"
"0","                                            longterm_output$intercept[i]+longterm_adj$value[i] +"
"0","                                              longterm_output$slope[i]*x, NA)}, col = ""orange"", lwd = 1) +"
"0","    labs(x = expression(Temperature~(degree~C)), y = expression(MBC~('mmol/kg'))) "
"0","}"
"0",""
"0","interannual_byStudy(longterm_output$tmin[1], longterm_output$tmax[1], 1) -> small_study1"
"0","interannual_byStudy(longterm_output$tmin[2], longterm_output$tmax[2], 2) -> small_study2"
"0","interannual_byStudy(longterm_output$tmin[3], longterm_output$tmax[3], 3) -> small_study3"
"0","interannual_byStudy(longterm_output$tmin[4], longterm_output$tmax[4], 4) -> small_study4"
"0","interannual_byStudy(longterm_output$tmin[5], longterm_output$tmax[5], 5) -> small_study5"
"0","interannual_byStudy(longterm_output$tmin[6], longterm_output$tmax[6], 6) -> small_study6"
"0",""
"0","(small_study1|small_study2) / (small_study3 | small_study4) / (small_study5 | small_study6) -> plot_by_study"
