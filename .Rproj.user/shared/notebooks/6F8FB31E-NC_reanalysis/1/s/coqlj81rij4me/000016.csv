"0","# plot MBC change vs warming magnitude"
"0","# simple linear regression first"
"0","lm(mbc_metadata$MBC_ROM ~ mbc_metadata$Magnitude_W) %>% summary()"
"1","
Call:
"
"1",""
"1","lm(formula = mbc_metadata$MBC_ROM ~ mbc_metadata$Magnitude_W)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.2799 "
"1","-0.1728 "
"1","-0.0087 "
"1"," 0.1437 "
"1"," 1.5675 "
"1","
"
"1","
Coefficients:
"
"1","                        "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","   "
"1","
(Intercept)             "
"1","  0.10053"
"1","    0.05296"
"1","   1.898"
"1","  0.05997"
"1"," . "
"1","
mbc_metadata$Magnitude_W"
"1"," -0.05170"
"1","    0.01976"
"1","  -2.617"
"1","  0.00997"
"1"," **"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.3225"
"1"," "
"1","on"
"1"," "
"1","125"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","因为不存在，3个观察量被删除了"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.05193"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.04435"
"1"," "
"1","
F-statistic:"
"1"," "
"1","6.847"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","125"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.009974"
"1","
"
"1","
"
"0","lm(mbc_metadata$MBC_ROM ~ mbc_metadata$Magnitude_W + I(mbc_metadata$Magnitude_W^2)) %>% summary() -> meta_lm_summary"
"0","tibble(a = meta_lm_summary$coefficients[1,1],"
"0","       b = meta_lm_summary$coefficients[2,1],"
"0","       c = meta_lm_summary$coefficients[3,1]) -> meta_nls_coef"
"0",""
"0","# y_max appear at"
"0","mbc_metadata %>% "
"0","  ggplot(aes(Magnitude_W, MBC_ROM)) +"
"0","  geom_point(aes(size = MBC_c_n), alpha = 0.5) +"
"0","  geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),"
"0","             aes(size = MBC_c_n), alpha = 1.0, col = ""blue"") +"
"0","  geom_point(data = mbc_metadata %>% filter(Paper %in% c(0)),"
"0","             aes(size = MBC_c_n), alpha = 1, col = ""black"") +"
"0","  # geom_smooth() +"
"0","  stat_function(fun = function(x) {meta_nls_coef$a + meta_nls_coef$b*x + meta_nls_coef$c*x^2},"
"0","                col = ""black"", size = 2)+"
"0","  geom_vline(xintercept = -meta_nls_coef$b/(2*meta_nls_coef$c), linetype=3, "
"0","                color = ""red"", size=1) +"
"0","  scale_y_continuous(labels = function(x) sprintf(""%.2f"", x)) +"
"0","  labs(x = expression(Warming~magnitude~(degree~C)),"
"0","       y = expression(LN~(RR))) +"
"0","  theme(legend.title=element_blank(),"
"0","        panel.background = element_rect(fill='transparent'),"
"0","        plot.background = element_rect(fill='transparent', color=NA),"
"0","        legend.background = element_rect(fill='transparent'), #transparent legend bg"
"0","        legend.position = c(0.80, 0.775)) +"
"0","  annotate(""text"", x = 1, y = -0.9, col = ""black"", hjust = 0,"
"0","           label = expression(""y=""~""-0.38+0.42x-0.08x""^2~(R[adj]^2~""=0.23, p<0.01""))) -> panel2"
"0",""
"0",""
"0","panel1 / panel2"
