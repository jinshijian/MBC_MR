"0","# function for reading data from excel"
"0","read_xlsx <- function(x, n_sheet, n_skip) read_excel(file.path(x), sheet = n_sheet, skip = n_skip)"
"0",""
"0","# creat function do linear regression for each region"
"0","lm_model <- function(sdata, var_region){"
"0","  lm <- lm(sdata$MBC_change ~ sdata$Temp_change)"
"0","  lm_sum <- summary(lm)"
"0","  intercept <- lm_sum$coefficients[1,1]"
"0","  slope <- lm_sum$coefficients[2,1]"
"0","  p_slope <- lm_sum$coefficients[2,4]"
"0","  tibble(region = var_region, "
"0","         intercept = intercept,"
"0","         slope = slope,"
"0","         p_slope = round(p_slope, 3)) -> out"
"0","  return (out)  }"
"0",""
"0","# plot world map"
"0","word_bkgd <- function (sdata) {"
"0","  ggplot(data = sdata) + "
"0","    # geom_polygon(aes(x = long, y = lat , fill = region , group = group, alpha = 0.1), color = ""white"") + "
"0","    geom_polygon(aes(x = long, y = lat, group = group, alpha = 0.1), color = ""white"", fill = ""gray"") + "
"0","    coord_fixed(1.3) +"
"0","    theme(axis.text.y   = element_text(size = 12),"
"0","          axis.text.x   = element_text(size = 12),"
"0","          axis.title.y   = element_text(size = 13, margin = margin(t = 0, r = 12, b = 0, l = 0)),"
"0","          axis.title.x   = element_text(size = 13, margin = margin(t = 12, r = 0, b = 0, l = 0)),"
"0","          panel.background = element_blank(),"
"0","          panel.grid.major = element_blank(), "
"0","          panel.grid.minor = element_blank(),"
"0","          axis.line = element_line(colour = ""black""),"
"0","          panel.border = element_rect(colour = ""black"", fill = NA, size = 1.25))+"
"0","    theme(legend.position = ""none"")+"
"0","    scale_x_continuous(name = ""Longitude"", breaks = seq(-180, 180, 30),"
"0","                       labels = seq(-180, 180, 30)) +"
"0","    scale_y_continuous(name = ""Latitude"", limits = c(-60, 90), breaks = seq(-90, 90, 15),"
"0","                       labels = seq(-90,90,15))"
"0","}"
"0",""
"0","# creat function do linear regression for each longterm experiment"
"0","longterm_model <- function(sdata, var_study){"
"0","  lm <- lm(sdata$MBC_c ~ sdata$Tannual_del)"
"0","  lm_sum <- summary(lm)"
"0","  intercept <- lm_sum$coefficients[1,1]"
"0","  slope <- lm_sum$coefficients[2,1]"
"0","  slope_se <- lm_sum$coefficients[2,2]"
"0","  p_slope <- lm_sum$coefficients[2,4]"
"0","  tibble(Study = var_study, "
"0","         intercept = intercept,"
"0","         slope = slope,"
"0","         slope_se = slope_se,"
"0","         p_slope = round(p_slope, 3),"
"0","         tmin = min(sdata$Tannual_del) %>% round(2),"
"0","         tmax = max(sdata$Tannual_del) %>% round(2)) -> out"
"0","  return (out)}"
"0",""
