geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine_fjoin
# add legend
plot_combine_fjoin +
geom_segment(aes(x = -3.7, y = -0.33, xend = -3.0, yend = -0.33),
col = "black", size = 1) +
geom_point(aes(x = -3.35, y = -0.33), col = "black", size = 2.5) +
geom_segment(aes(x = -3.7, y = -0.4, xend = -3.0, yend = -0.4),
col = "blue", size = 1) +
geom_point(aes(x = -3.35, y = -0.4), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.33, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.4, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_combine_fjoin
plot_combine_fjoin
plot_patoine_fjoin / plot_combine_fjoin + plot_annotation(tag_levels = "a")
# ggsave(here("output/figures", "resample_m500_200_times_fjoin.png"), width = 7, height = 7)
RegrressionTest2(sdata = resample_lm_output500_comb_fjoin,
ymin = -0.45, ymax = 0.2) -> plot_combine_fjoin
# get reression
summary(lm(resample_lm_output500_comb_fjoin$slope ~ resample_lm_output500_comb_fjoin$outslope))
plot_combine_fjoin +
geom_point(aes(x = -4.6070, y = -0.1206), col = "black", size = 2) +
geom_segment(aes(x = -4.6070, y = -0.1206-2*0.05, xend = -4.6070, yend = -0.1206+2*0.05),
col = "black", size = 1) +
annotate("text", x = -7.5, y = -0.4,
label = expression("Slope = 0.012, "~R^{2}~" = 0.09, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine_fjoin
# add results for patoine
plot_combine_fjoin +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine_fjoin
# add legend
plot_combine_fjoin +
geom_segment(aes(x = -3.7, y = -0.33, xend = -3.0, yend = -0.33),
col = "black", size = 1) +
geom_point(aes(x = -3.35, y = -0.33), col = "black", size = 2.5) +
geom_segment(aes(x = -3.7, y = -0.4, xend = -3.0, yend = -0.4),
col = "blue", size = 1) +
geom_point(aes(x = -3.35, y = -0.4), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.33, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.4, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_combine_fjoin
plot_combine_fjoin
plot_patoine_fjoin / plot_combine_fjoin + plot_annotation(tag_levels = "a")
# ggsave(here("output/figures", "resample_m500_200_times_fjoin.png"), width = 7, height = 7)
ggsave(here("output/figures", "resample_m500_200_times_fjoin.png"), width = 7, height = 7)
panel_quadratic/panel_slr_v3 +
plot_annotation(tag_levels = 'a') &
theme(plot.tag = element_text(size = 20, hjust = -2, vjust = 0, face = "bold"))
# ggsave(here("output/figures", "Figure_quadratic_v2.png"), width = 8, height = 8)
panel_quadratic
panel_quadratic
ggsave(here("output/figures", "Figure_quadratic.png"), width = 8, height = 4)
panel_slr_v3
ggsave(here("output/figures", "Figure_slr_v3.png"), width = 8, height = 4)
cofr <- raster(here("geodata/resampled_0p05deg/static/cfvo", "cfvo_5-15cm_mean_resamp_c2021-02-14_163601.tif"))
View(cofr)
#*******************************************************************************
# Calculate and compare temporal trends of all predictions -----------------
#*******************************************************************************
library(raster)
library(tools)
library(sf)
library(tidyverse)
library(here)
library(doParallel)
library(foreach)
library(caret)
library(CAST)
library(cowplot)
library(grid)
library(gridExtra)
library(ggExtra)
library(forcats)
library(magick)
library(biscale)
library(gt)
# library(glcpck)
# install.packages('qdapRegex')
library(qdapRegex)
source(here::here("code/functions.R"))
# calculate cstocks
bulk <- raster(here("geodata/resampled_0p05deg/static/bdod", "bdod_5-15cm_mean_resamp_c2021-02-14_153856.tif"))
cofr <- raster(here("geodata/resampled_0p05deg/static/cfvo", "cfvo_5-15cm_mean_resamp_c2021-02-14_163601.tif"))
rarea <- raster::area(cofr)
st <- stack(bulk, cofr, rarea)
names(st) <- c("bulk", "cofr", "area")
View(bulk)
View(rarea)
View(rarea)
raster::area(cofr)
panel_meta
panel_LT
site_meta
site_meta
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 3, size = 2, alpha = 0.75, stroke = 1)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 2, alpha = 0.75, stroke = 1)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1)
longterm_data_del
View(longterm_data_del)
longterm_data_del %>% filter(PaperID = 68)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3, alpha = 0.75, stroke = 1)
# plot meta sites
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# legend
geom_point(data = tibble(x = rep(-170, 3), y = c(-25, -40, -55), size = 1),
aes(x, y, size = c(3,3,3))
, shape = c(1, 16, 3)
, color = c("black", "blue", "red"), alpha = 1, stroke = 1)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# legend
geom_point(data = tibble(x = rep(-170, 3), y = c(-25, -40, -55), size = 1),
aes(x, y, size = c(3,3,3))
, shape = c(1, 16, 0)
, color = c("black", "blue", "red"), alpha = 1, stroke = 1)
# plot meta sites
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# legend
geom_point(data = tibble(x = rep(-170, 4), y = c(-10, -25, -40, -55), size = 1),
aes(x, y, size = c(3,3,3,3))
, shape = c(1, 16, 0, 0)
, color = c("black", "blue", "red", "blue"), alpha = 1, stroke = 1)
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# legend
geom_point(data = tibble(x = rep(-170, 4), y = c(-10, -25, -40, -55), size = 1),
aes(x, y, size = c(3,3,3,3))
, shape = c(1, 16, 0, 0)
, color = c("black", "blue", "red", "blue"), alpha = 1, stroke = 1) +
annotate("text", x = -160, y = c(-10, -25, -40, -55),
label = c("Warming experiment", "Within Patoine et al.", "Long-term sites", "Within Patoine et al."),
size = c(3,3,3,3), hjust = 0)
# plot meta sites
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 3, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3, alpha = 0.75, stroke = 1) +
# legend
geom_point(data = tibble(x = rep(-170, 4), y = c(-10, -25, -40, -55), size = 1),
aes(x, y, size = c(3,3,3,3))
, shape = c(1, 16, 0, 0)
, color = c("black", "blue", "red", "blue"), alpha = 1, stroke = 1) +
annotate("text", x = -160, y = c(-10, -25, -40, -55),
label = c("Warming experiment", "Within Patoine et al.", "Long-term sites", "Within Patoine et al."),
size = c(3,3,3,3), hjust = 0) +
geom_point(data = size_legend, aes(x, y, size = size)
, shape = c(1, 1, 1, 1)
, color = c("black"), alpha = 1, stroke = 1) +
annotate("text", x = 180, y = c(45,30,15,0),
label = c("2", "4", "6", "8"),
size = c(3,3,3,3), hjust = 0) +
annotate("text", y=c(36.13,58.44,50.12,42.45,-15.6,-37.8),
x=c(137.42,-93.48,7.31,116.67,-47.6,175.25),
label = c("LT1","LT2","LT3","LT4","LT5","LT6"),
col = "red", vjust = -1) -> site_meta
site_meta
panel_meta
panel_LT
longterm_output %>%
ggplot(aes(x=slope, y=Study2)) +
geom_point(alpha = 0.5, col = "red") +
# geom_smooth(method = "lm", se = FALSE) +
labs(x = expression(Linear~model~slope~(mmol~kg^-1~degree~C^-1)), y = "") +
geom_vline(xintercept = 0, linetype = 2,
color = "black", size = 1) +
geom_pointrange(aes(xmin=xmin,  xmax = High), col = "red", shape = 0) +
geom_segment(aes(x=-0.8, y=68, xend=-0.70, yend=68), col = "red") +
geom_segment(aes(x=-0.7, y=67.5, xend=-0.7, yend=68), col = "red") +
geom_segment(aes(x=-0.65, y=68.5, xend=-0.65, yend=68), col = "red") +
geom_segment(aes(x=-0.7, y=67.5, xend=-0.65, yend=68.5), col = "red") +
# xlim(c(-0.8, 0.3)) +
scale_y_continuous(position = "right",
breaks = c(68:73) ,labels = c("LT6", "LT5", "LT4", "LT3", "LT2", "LT1")) +
theme(axis.title.y = element_blank()) -> panel_LT
panel_LT
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = -2, vjust = 0, face = "bold"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
sessionInfo()
panel_meta
Meta_subset %>%
ggplot(aes(x=Mean, y=ID)) +
geom_point(shape = c(16,16,16,16,16,15), col = c("gray","gray","gray","gray","gray","black"))+
# geom_smooth(method = "lm", se = FALSE) +
labs(x = 'LN (response ratio)', y = "") +
geom_vline(xintercept = 0, linetype = 2, color = "black", size = 1) +
# geom_hline(yintercept = c(2,1), linetype = 1, color = "black", size = 0.5) +
annotate("rect", xmin = -0.4, xmax = 0.3, ymin = 1.25, ymax = 2.25, alpha = 0.0) +
geom_pointrange(aes(xmin=Low, xmax = High), col = "black", alpha = 0.5) +
geom_hline(yintercept = 2.25, linetype = 3, color = "black", size = 0.5)+
# xlim(c(-0.2, 0.2)) +
geom_point(aes(x=-0.01005034, y=1.75), shape = 16, size = 3.5)+
scale_y_continuous(position = "left", breaks = c(Meta_subset$ID,1), labels = c(Meta_subset$Subgroup,"")) +
theme(axis.title.y = element_blank())  -> panel_meta
panel_meta
Meta_subset %>%
ggplot(aes(x=Mean, y=ID)) +
geom_point(shape = c(16,16,16,16,16,15), col = c("gray","gray","gray","gray","gray","black"))+
# geom_smooth(method = "lm", se = FALSE) +
labs(x = 'LN (response ratio)', y = "") +
geom_vline(xintercept = 0, linetype = 2, color = "black", size = 1) +
# geom_hline(yintercept = c(2,1), linetype = 1, color = "black", size = 0.5) +
annotate("rect", xmin = -0.4, xmax = 0.3, ymin = 1.25, ymax = 2.25, alpha = 0.0) +
geom_pointrange(aes(xmin=Low, xmax = High), col = "black", alpha = 0.5) +
geom_hline(yintercept = 2.25, linetype = 3, color = "black", size = 0.5)+
# xlim(c(-0.2, 0.2)) +
geom_point(aes(x=-0.01005034, y=1.75), shape = 16, size = 5)+
scale_y_continuous(position = "left", breaks = c(Meta_subset$ID,1), labels = c(Meta_subset$Subgroup,"")) +
theme(axis.title.y = element_blank())  -> panel_meta
panel_meta
Meta_subset %>%
ggplot(aes(x=Mean, y=ID)) +
geom_point(shape = c(16,16,16,16,16,15), col = c("gray","gray","gray","gray","gray","black"))+
# geom_smooth(method = "lm", se = FALSE) +
labs(x = 'LN (response ratio)', y = "") +
geom_vline(xintercept = 0, linetype = 2, color = "black", size = 1) +
# geom_hline(yintercept = c(2,1), linetype = 1, color = "black", size = 0.5) +
annotate("rect", xmin = -0.4, xmax = 0.3, ymin = 1.25, ymax = 2.25, alpha = 0.0) +
geom_pointrange(aes(xmin=Low, xmax = High), col = "black", alpha = 0.5) +
geom_hline(yintercept = 2.25, linetype = 3, color = "black", size = 0.5)+
# xlim(c(-0.2, 0.2)) +
geom_point(aes(x=-0.01005034, y=1.75), shape = 16, size = 4)+
scale_y_continuous(position = "left", breaks = c(Meta_subset$ID,1), labels = c(Meta_subset$Subgroup,"")) +
theme(axis.title.y = element_blank())  -> panel_meta
panel_meta
longterm_output %>%
ggplot(aes(x=slope, y=Study2)) +
geom_point(alpha = 0.5, col = "red") +
# geom_smooth(method = "lm", se = FALSE) +
labs(x = expression(Linear~model~slope~(mmol~kg^-1~degree~C^-1)), y = "") +
geom_vline(xintercept = 0, linetype = 2,
color = "black", size = 1)
longterm_output %>%
ggplot(aes(x=slope, y=Study2)) +
# geom_point(alpha = 0.5, col = "red") +
# geom_smooth(method = "lm", se = FALSE) +
labs(x = expression(Linear~model~slope~(mmol~kg^-1~degree~C^-1)), y = "") +
geom_vline(xintercept = 0, linetype = 2,
color = "black", size = 1) +
geom_pointrange(aes(xmin=xmin,  xmax = High), col = "red", shape = 0) +
geom_segment(aes(x=-0.8, y=68, xend=-0.70, yend=68), col = "red") +
geom_segment(aes(x=-0.7, y=67.5, xend=-0.7, yend=68), col = "red") +
geom_segment(aes(x=-0.65, y=68.5, xend=-0.65, yend=68), col = "red") +
geom_segment(aes(x=-0.7, y=67.5, xend=-0.65, yend=68.5), col = "red") +
# xlim(c(-0.8, 0.3)) +
scale_y_continuous(position = "right",
breaks = c(68:73) ,labels = c("LT6", "LT5", "LT4", "LT3", "LT2", "LT1")) +
theme(axis.title.y = element_blank())
longterm_output %>%
ggplot(aes(x=slope, y=Study2)) +
# geom_point(alpha = 0.5, col = "red") +
# geom_smooth(method = "lm", se = FALSE) +
labs(x = expression(Linear~model~slope~(mmol~kg^-1~degree~C^-1)), y = "") +
geom_vline(xintercept = 0, linetype = 2,
color = "black", size = 1) +
geom_pointrange(aes(xmin=xmin,  xmax = High), col = "red", shape = 0) +
geom_segment(aes(x=-0.8, y=68, xend=-0.70, yend=68), col = "red") +
geom_segment(aes(x=-0.7, y=67.5, xend=-0.7, yend=68), col = "red") +
geom_segment(aes(x=-0.65, y=68.5, xend=-0.65, yend=68), col = "red") +
geom_segment(aes(x=-0.7, y=67.5, xend=-0.65, yend=68.5), col = "red") +
# xlim(c(-0.8, 0.3)) +
scale_y_continuous(position = "right",
breaks = c(68:73) ,labels = c("LT6", "LT5", "LT4", "LT3", "LT2", "LT1")) +
theme(axis.title.y = element_blank()) -> panel_LT
panel_meta
panel_LT
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = -2, vjust = 0, face = "bold"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
# plot meta sites
basemap +
geom_point(data = meta_count, aes(x = meta_count$Longitude, y = meta_count$Latitude),
color = "black", shape = 1, size = meta_count$n, alpha = 1, stroke = 1) +
geom_point(data = mbc_metadata %>% filter(Paper %in% c(68,69)),
aes(x = Longitude, y = Latitude),
color = "blue", shape = 16, size = 2, alpha = 1) +
geom_point(data = longterm_data_del, aes(x = Longitude, y = Latitude),
color = "red", shape = 0, size = 3.5, alpha = 0.75, stroke = 1) +
# longterm site in patoine
geom_point(data = longterm_data_del %>% filter(PaperID == 68), aes(x = Longitude, y = Latitude),
color = "blue", shape = 0, size = 3.5, alpha = 0.75, stroke = 1) +
# legend
geom_point(data = tibble(x = rep(-170, 4), y = c(-10, -25, -40, -55), size = 1),
aes(x, y, size = c(3,3,3,3))
, shape = c(1, 16, 0, 0)
, color = c("black", "blue", "red", "blue"), alpha = 1, stroke = 1) +
annotate("text", x = -160, y = c(-10, -25, -40, -55),
label = c("Warming experiment", "Within Patoine et al.", "Long-term sites", "Within Patoine et al."),
size = c(3,3,3,3), hjust = 0) +
geom_point(data = size_legend, aes(x, y, size = size)
, shape = c(1, 1, 1, 1)
, color = c("black"), alpha = 1, stroke = 1) +
annotate("text", x = 180, y = c(45,30,15,0),
label = c("2", "4", "6", "8"),
size = c(3,3,3,3), hjust = 0) +
annotate("text", y=c(36.13,58.44,50.12,42.45,-15.6,-37.8),
x=c(137.42,-93.48,7.31,116.67,-47.6,175.25),
label = c("LT1","LT2","LT3","LT4","LT5","LT6"),
col = "red", vjust = -1) -> site_meta
site_meta
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = -2, vjust = 0, face = "bold"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
sessionInfo()
site_meta
View(meta_count)
View(mbc_metadata)
panel_meta
Meta_subset %>%
ggplot(aes(x=Mean, y=ID)) +
geom_point(shape = c(16,16,16,16,16,15), col = c("gray","gray","gray","gray","gray","black"))+
# geom_smooth(method = "lm", se = FALSE) +
labs(x = 'LN (response ratio)', y = "") +
geom_vline(xintercept = 0, linetype = 2, color = "black", size = 1) +
# geom_hline(yintercept = c(2,1), linetype = 1, color = "black", size = 0.5) +
annotate("rect", xmin = -0.4, xmax = 0.3, ymin = 1.25, ymax = 2.25, alpha = 0.0) +
geom_pointrange(aes(xmin=Low, xmax = High), col = "black", alpha = 0.5) +
geom_hline(yintercept = 2.25, linetype = 3, color = "black", size = 0.5)+
# xlim(c(-0.2, 0.2)) +
geom_point(aes(x=-0.01005034, y=1.75), shape = 16)+
scale_y_continuous(position = "left", breaks = c(Meta_subset$ID,1), labels = c(Meta_subset$Subgroup,"")) +
theme(axis.title.y = element_blank())  -> panel_meta
panel_meta
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = -2, vjust = 0, face = "bold"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(-2,-2,0), vjust = 0, face = "bold"))
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(-2,-2,-2), vjust = 0, face = "bold"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(-1,-1,-1), vjust = 0, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = 0, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0.1,0,0), vjust = 0, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(1,0,0), vjust = 0, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = 0, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = c(1,0,0), face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = 0, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = 0.1, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = -0.1, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = c(0,0,0), vjust = -0.2, face = "bold"))
# cowplot::plot_grid(panel_LT, panel_meta, labels = c("b", "c"))
ggsave(here("output/figures", "site_meta_longterm.png"), width = 8, height = 8)
