lm(mbc_Patoine$Cmic ~ mbc_Patoine$tmean_c)
lm(mbc_Patoine$Cmic ~ mbc_Patoine$tmean_c) -> patoine_mbc_mat_lm
patoine_mbc_mat_lm
patoine_mbc_mat_lm$coefficients
patoine_mbc_mat_lm$coefficients[2]
patoine_mbc_mat_lm$coefficients[2] -> patoine_mbc_mat_lm_slope
patoine_mbc_mat_lm_slope
RegrressionTest2(sdata = resample_lm_output500,
ymin = -0.65, ymax = 0.1) -> plot_patoine
plot_patoine +
geom_point(aes(x = -2.9613, y = -0.1434), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.1434-2*0.06759, xend = -2.9613, yend = -0.1434+2*0.06759),
col = "black", size = 1) -> plot_patoine
plot_patoine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = -0.162), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = -0.308, xend = patoine_mbc_mat_lm_slope, yend = -0.016),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_patoine
# add legend
plot_patoine +
geom_segment(aes(x = -2.25, y = -0.45, xend = -1.75, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.0, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.25, y = -0.55, xend = -1.75, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.0, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -1.5, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -1.5, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_patoine
plot_patoine
View(Patoine_sum)
Patoine_data
mbc_Patoine
mbc_metadata
longterm_data_del
mbc_metacsv_ndvi
Meta_subset
mbc_Patoine
mbc_metadata
mbc_Patoine
Meta_subset
Meta_subset$ID[6]
site_meta + (panel_meta + panel_LT) +
plot_layout(heights = c(2, 1.5)) +
plot_annotation(tag_levels = 'a') &
theme(plot.tag.position = c(0.02, 1.01), plot.tag = element_text(vjust = 2)) &
theme(plot.tag = element_text(size = 15, hjust = -2, vjust = 0, face = "bold"))
Meta_subset
Meta_subset
Meta_subset
mbc_Patoine
mbc_metadata
Patoine_data
Patoine_data
Patoine_data$Low[1]
Patoine_data
Patoine_data$High[1]
Patoine_data$Low[1] -> patoine_low
Patoine_data$High[1] -> patoine_high
patoine_high
RegrressionTest2(sdata = resample_lm_output500,
ymin = -0.65, ymax = 0.1) -> plot_patoine
plot_patoine
plot_patoine +
geom_point(aes(x = -2.9613, y = -0.1434), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.1434-2*0.06759, xend = -2.9613, yend = -0.1434+2*0.06759),
col = "black", size = 1)
plot_patoine +
geom_point(aes(x = -2.9613, y = -0.1434), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.1434-2*0.06759, xend = -2.9613, yend = -0.1434+2*0.06759),
col = "black", size = 1) -> plot_patoine
plot_patoine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = -0.162), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0)
Patoine_data
Patoine_data$Mean[1] -> patoine_mean
patoine_mean
patoine_mbc_mat_lm$coefficients
bind_rows(
sum_slope (resample_lm_output500, ID = 1, "500_patoine", n = nrow(resample_lm_output500)),
sum_slope (resample_lm_output500_comb, ID = 2, "500_combine", n = nrow(resample_lm_output500_comb))
)
sum_slope
resample_lm_output500
bind_rows(
sum_slope (resample_lm_output500, ID = 1, "500_patoine", n = nrow(resample_lm_output500)),
sum_slope (resample_lm_output500_comb, ID = 2, "500_combine", n = nrow(resample_lm_output500_comb)))
RegrressionTest2(sdata = resample_lm_output500,
ymin = -0.65, ymax = 0.1) -> plot_patoine
plot_patoine +
geom_point(aes(x = -2.9613, y = -0.1434), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.1434-2*0.06759, xend = -2.9613, yend = -0.1434+2*0.06759),
col = "black", size = 1) -> plot_patoine
plot_patoine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_patoine
# add legend
plot_patoine +
geom_segment(aes(x = -2.25, y = -0.45, xend = -1.75, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.0, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.25, y = -0.55, xend = -1.75, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.0, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -1.5, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -1.5, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_patoine
plot_patoine
# 500 resample
summary(lm(resample_lm_output500$outslope ~ resample_lm_output500$slope))
summary(lm(resample_lm_output500$slope ~ resample_lm_output500$outslope))
# get the linear regression between rate_of_change and outslope
summary(lm(resample_lm_output500$slope ~ resample_lm_output500$outslope))
summary(lm(resample_lm_output500_comb$slope ~ resample_lm_output500_comb$outslope))
RegrressionTest2(sdata = resample_lm_output500_comb,
ymin = -0.45, ymax = 0.2) -> plot_combine
summary(lm(resample_lm_output500_comb$slope ~ resample_lm_output500_comb$outslope))
plot_combine +
geom_point(aes(x = -4.6070, y = -0.0920), col = "black", size = 2) +
geom_segment(aes(x = -4.6070, y = -0.0920-2*0.0588, xend = -4.6070, yend = -0.0920+2*0.0588),
col = "black", size = 1) +
annotate("text", x = -7.5, y = -0.4,
label = expression("Slope = 0.006, "~R^{2}~" = 0.03, p = 0.01"),
hjust = 0, angle = 0) -> plot_combine
# add results for a signle run
# plot_combine +
#   geom_point(aes(x = -4.6434, y = -0.1261), col = "blue", size = 2) +
#   geom_segment(aes(x = -4.6434,  y= -0.1261-2*0.0526, xend = -4.6434, yend = -0.1261+2*0.0526),
#                col = "blue", size = 1) -> plot_combine
# add results for patoine
plot_combine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine
# add legend
plot_combine +
geom_segment(aes(x = -3.7, y = -0.33, xend = -3.0, yend = -0.33),
col = "black", size = 1) +
geom_point(aes(x = -3.35, y = -0.33), col = "black", size = 2.5) +
geom_segment(aes(x = -3.7, y = -0.4, xend = -3.0, yend = -0.4),
col = "blue", size = 1) +
geom_point(aes(x = -3.35, y = -0.4), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.33, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.4, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_combine
plot_combine
Patoine_data %>% filter(Scenario == "All" & Study == "Patoine et al.")
summary(lm(mbc_Patoine$Cmic ~ mbc_Patoine$tmean))
summary(lm(resample_lm_output500$slope ~ resample_lm_output500$outslope))
summary(lm(resample_lm_output500_comb$slope ~ resample_lm_output500_comb$outslope))
resample_lm_output500_comb$slope %>% mean()
resample_lm_output500_comb$outslope %>% mean()
summary(lm(mbc_Patoine$Cmic ~ mbc_Patoine$tmean))
summary(lm(mbc_Patoine$Cmic ~ mbc_Patoine$tmean_c))
summary(lm(resample_lm_output500$slope ~ resample_lm_output500$outslope))
summary(lm(resample_lm_output500_comb$slope ~ resample_lm_output500_comb$outslope))
resample_lm_output500_comb$slope %>% mean()
resample_lm_output500_comb$outslope %>% mean()
RegrressionTest2(sdata = resample_lm_output500_comb,
ymin = -0.45, ymax = 0.2)
sum_slope (resample_lm_output500, ID = 1, "500_patoine", n = nrow(resample_lm_output500))
resample_lm_output500_comb$slope %>% mean()
resample_lm_output500_comb$outslope %>% mean()
sum_slope (resample_lm_output500_comb, ID = 2, "500_combine", n = nrow(resample_lm_output500_comb))
RegrressionTest2(sdata = sub_resample_lm_output500,
ymin = -0.6,
ymax = 0) -> sub_plot_patoine
sub_plot_patoine +
annotate("text", x = -5, y = -0.58, label = expression("Slope = 0.04, "~R^{2}~" = 0.33, p < 0.01"),
hjust = 0, angle = 0) -> sub_plot_patoine
sub_plot_patoine +
geom_point(aes(x = sub_patoine_lm_summary$Slope_MAT_MBC, y = sub_patoine_lm_summary$Rate_of_change),
col = "black", size = 2) +
geom_segment(aes(x = sub_patoine_lm_summary$Slope_MAT_MBC,
y = sub_patoine_lm_summary$Rate_of_change-2*sub_patoine_lm_summary$slope_se,
xend = sub_patoine_lm_summary$Slope_MAT_MBC,
yend = sub_patoine_lm_summary$Rate_of_change+2*sub_patoine_lm_summary$slope_se),
col = "black", size = 1) -> sub_plot_patoine
Patoine_data %>% filter(Scenario == "All" & Study == "Patoine et al.") %>%
mutate(ID = 2)
sub_plot_patoine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) -> sub_plot_patoine
# add legend
sub_plot_patoine +
geom_segment(aes(x = -2.75, y = -0.45, xend = -2.25, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.5, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.75, y = -0.55, xend = -2.25, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.5, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -2.15, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.15, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
sub_plot_patoine
sub_plot_patoine
sum_slope (sub_resample_lm_output500_comb, ID = 4, "sub_500_combine",
n = nrow(sub_resample_lm_output500_comb))
RegrressionTest2(sdata = sub_resample_lm_output500_comb,
ymin = -0.4,
ymax = 0) -> sub_plot_combine
sub_plot_combine +
annotate("text", x = -7.5, y = -0.38, label = expression("Slope = 0.009, "~R^{2}~" = 0.14, p < 0.01"),
hjust = 0, angle = 0) -> sub_plot_combine
# get average of all runs
sum_slope (sub_resample_lm_output500_comb, ID = 4, "sub_500_combine", n = 59)
sub_plot_combine +
geom_point(aes(x = -4.21366, y = -0.12277), col = "black", size = 2) +
geom_segment(aes(x = -4.21366, y = -0.12277-2*0.0499, xend = -4.21366, yend = -0.12277+2*0.0499),
col = "black", size = 1) -> sub_plot_combine
# get results from the sinple run
# add information for patoine
sub_plot_combine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) -> sub_plot_combine
# add legend
sub_plot_combine +
geom_segment(aes(x = -4.0, y = -0.32, xend = -3.0, yend = -0.32),
col = "black", size = 1) +
geom_point(aes(x = -3.5, y = -0.32), col = "black", size = 2.5) +
geom_segment(aes(x = -4.0, y = -0.375, xend = -3.0, yend = -0.375),
col = "blue", size = 1) +
geom_point(aes(x = -3.5, y = -0.375), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.32, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.375, label = "Patoine et al.", col = "blue", hjust = 0) ->
sub_plot_combine
sub_plot_combine
sum_slope (resample_lm_output500_fjoin, ID = 5, "500_patoine_fjoin",
n = nrow(resample_lm_output500_fjoin))
RegrressionTest2(sdata = resample_lm_output500_fjoin,
ymin = -0.65, ymax = 0.1)
RegrressionTest2(sdata = resample_lm_output500_fjoin,
ymin = -0.65, ymax = 0.1) -> plot_patoine_fjoin
RegrressionTest2(sdata = resample_lm_output500_fjoin,
ymin = -0.65, ymax = 0.1) -> plot_patoine_fjoin
plot_patoine_fjoin +
geom_point(aes(x = -2.9613, y = -0.2145), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.2145-2*0.09472, xend = -2.9613, yend = -0.2145+2*0.09472),
col = "black", size = 1)
plot_patoine_fjoin +
geom_point(aes(x = -2.9613, y = -0.2145), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.2145-2*0.09472, xend = -2.9613, yend = -0.2145+2*0.09472),
col = "black", size = 1) -> plot_patoine_fjoin
# get the linear regression between rate_of_change and outslope
summary(lm(resample_lm_output500_fjoin$slope ~ resample_lm_output500_fjoin$outslope))
plot_patoine_fjoin +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.068, "~R^{2}~" = 0.36, p < 0.01"),
hjust = 0, angle = 0)
plot_patoine_fjoin +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.068, "~R^{2}~" = 0.36, p < 0.01"),
hjust = 0, angle = 0) -> plot_patoine_fjoin
plot_patoine_fjoin +
geom_segment(aes(x = -2.25, y = -0.45, xend = -1.75, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.0, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.25, y = -0.55, xend = -1.75, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.0, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -1.5, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -1.5, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0)
# add legend
plot_patoine_fjoin +
geom_segment(aes(x = -2.25, y = -0.45, xend = -1.75, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.0, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.25, y = -0.55, xend = -1.75, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.0, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -1.5, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -1.5, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_patoine_fjoin
plot_patoine_fjoin
sum_slope (resample_lm_output500_comb_fjoin, ID = 6, "500_combine",
n = nrow(resample_lm_output500_comb_fjoin))
RegrressionTest2(sdata = resample_lm_output500_comb_fjoin,
ymin = -0.45, ymax = 0.2) -> plot_combine
plot_combine
# get reression
summary(lm(resample_lm_output500_comb_fjoin$slope ~ resample_lm_output500_comb_fjoin$outslope))
plot_combine
plot_combine +
geom_point(aes(x = -4.6070, y = -0.1206), col = "black", size = 2) +
geom_segment(aes(x = -4.6070, y = -0.1206-2*0.05, xend = -4.6070, yend = -0.1206+2*0.05),
col = "black", size = 1) +
annotate("text", x = -7.5, y = -0.4,
label = expression("Slope = 0.0119, "~R^{2}~" = 0.088, p < 0.01"),
hjust = 0, angle = 0)
plot_combine +
geom_point(aes(x = -4.6070, y = -0.1206), col = "black", size = 2) +
geom_segment(aes(x = -4.6070, y = -0.1206-2*0.05, xend = -4.6070, yend = -0.1206+2*0.05),
col = "black", size = 1) +
annotate("text", x = -7.5, y = -0.4,
label = expression("Slope = 0.0119, "~R^{2}~" = 0.088, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine
plot_combine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0)
# add results for patoine
plot_combine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine
# add legend
plot_combine +
geom_segment(aes(x = -3.7, y = -0.33, xend = -3.0, yend = -0.33),
col = "black", size = 1) +
geom_point(aes(x = -3.35, y = -0.33), col = "black", size = 2.5) +
geom_segment(aes(x = -3.7, y = -0.4, xend = -3.0, yend = -0.4),
col = "blue", size = 1) +
geom_point(aes(x = -3.35, y = -0.4), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.33, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.4, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_combine
plot_combine
RegrressionTest2(sdata = resample_lm_output500_comb_fjoin,
ymin = -0.45, ymax = 0.2) -> plot_combine_fjoin
# get reression
summary(lm(resample_lm_output500_comb_fjoin$slope ~ resample_lm_output500_comb_fjoin$outslope))
plot_combine_fjoin +
geom_point(aes(x = -4.6070, y = -0.1206), col = "black", size = 2) +
geom_segment(aes(x = -4.6070, y = -0.1206-2*0.05, xend = -4.6070, yend = -0.1206+2*0.05),
col = "black", size = 1) +
annotate("text", x = -7.5, y = -0.4,
label = expression("Slope = 0.0119, "~R^{2}~" = 0.088, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine_fjoin
# add results for patoine
plot_combine_fjoin +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine_fjoin
# add legend
plot_combine_fjoin +
geom_segment(aes(x = -3.7, y = -0.33, xend = -3.0, yend = -0.33),
col = "black", size = 1) +
geom_point(aes(x = -3.35, y = -0.33), col = "black", size = 2.5) +
geom_segment(aes(x = -3.7, y = -0.4, xend = -3.0, yend = -0.4),
col = "blue", size = 1) +
geom_point(aes(x = -3.35, y = -0.4), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.33, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.4, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_combine_fjoin
plot_combine_fjoin
RegrressionTest2(sdata = resample_lm_output500_fjoin,
ymin = -0.65, ymax = 0.1) -> plot_patoine_fjoin
plot_patoine_fjoin +
geom_point(aes(x = -2.9613, y = -0.2145), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.2145-2*0.09472, xend = -2.9613, yend = -0.2145+2*0.09472),
col = "black", size = 1) -> plot_patoine_fjoin
# get the linear regression between rate_of_change and outslope
summary(lm(resample_lm_output500_fjoin$slope ~ resample_lm_output500_fjoin$outslope))
plot_patoine_fjoin +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.068, "~R^{2}~" = 0.36, p < 0.01"),
hjust = 0, angle = 0) -> plot_patoine_fjoin
# add legend
plot_patoine_fjoin +
geom_segment(aes(x = -2.25, y = -0.45, xend = -1.75, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.0, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.25, y = -0.55, xend = -1.75, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.0, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -1.5, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -1.5, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_patoine_fjoin
plot_patoine_fjoin
plot_patoine_fjoin / plot_combine_fjoin
# ggsave(here("output/figures", "resample_m500_200_times.png"), width = 7, height = 7)
ggsave(here("output/figures", "resample_m500_200_times_fjoin.png"), width = 7, height = 7)
plot_patoine_fjoin
RegrressionTest2(sdata = sub_resample_lm_output500,
ymin = -0.6,
ymax = 0) -> sub_plot_patoine
sub_plot_patoine +
annotate("text", x = -5, y = -0.58, label = expression("Slope = 0.04, "~R^{2}~" = 0.33, p < 0.01"),
hjust = 0, angle = 0) -> sub_plot_patoine
sub_plot_patoine +
geom_point(aes(x = sub_patoine_lm_summary$Slope_MAT_MBC, y = sub_patoine_lm_summary$Rate_of_change),
col = "black", size = 2) +
geom_segment(aes(x = sub_patoine_lm_summary$Slope_MAT_MBC,
y = sub_patoine_lm_summary$Rate_of_change-2*sub_patoine_lm_summary$slope_se,
xend = sub_patoine_lm_summary$Slope_MAT_MBC,
yend = sub_patoine_lm_summary$Rate_of_change+2*sub_patoine_lm_summary$slope_se),
col = "black", size = 1) -> sub_plot_patoine
Patoine_data %>% filter(Scenario == "All" & Study == "Patoine et al.") %>%
mutate(ID = 2)
sub_plot_patoine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) -> sub_plot_patoine
# add legend
sub_plot_patoine +
geom_segment(aes(x = -2.75, y = -0.45, xend = -2.25, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.5, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.75, y = -0.55, xend = -2.25, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.5, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -2.15, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.15, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
sub_plot_patoine
sub_plot_patoine
RegrressionTest2(sdata = resample_lm_output500_comb,
ymin = -0.45, ymax = 0.2) -> plot_combine
# get reression
summary(lm(resample_lm_output500_comb$slope ~ resample_lm_output500_comb$outslope))
plot_combine +
geom_point(aes(x = -4.6070, y = -0.0920), col = "black", size = 2) +
geom_segment(aes(x = -4.6070, y = -0.0920-2*0.0588, xend = -4.6070, yend = -0.0920+2*0.0588),
col = "black", size = 1) +
annotate("text", x = -7.5, y = -0.4,
label = expression("Slope = 0.006, "~R^{2}~" = 0.03, p = 0.01"),
hjust = 0, angle = 0) -> plot_combine
# add results for a signle run
# plot_combine +
#   geom_point(aes(x = -4.6434, y = -0.1261), col = "blue", size = 2) +
#   geom_segment(aes(x = -4.6434,  y= -0.1261-2*0.0526, xend = -4.6434, yend = -0.1261+2*0.0526),
#                col = "blue", size = 1) -> plot_combine
# add results for patoine
plot_combine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.05, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_combine
# add legend
plot_combine +
geom_segment(aes(x = -3.7, y = -0.33, xend = -3.0, yend = -0.33),
col = "black", size = 1) +
geom_point(aes(x = -3.35, y = -0.33), col = "black", size = 2.5) +
geom_segment(aes(x = -3.7, y = -0.4, xend = -3.0, yend = -0.4),
col = "blue", size = 1) +
geom_point(aes(x = -3.35, y = -0.4), col = "blue", size = 2.5) +
annotate("text", x = -2.75, y = -0.33, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -2.75, y = -0.4, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_combine
plot_combine
RegrressionTest2(sdata = resample_lm_output500,
ymin = -0.65, ymax = 0.1) -> plot_patoine
plot_patoine +
geom_point(aes(x = -2.9613, y = -0.1434), col = "black", size = 2) +
geom_segment(aes(x = -2.9613, y = -0.1434-2*0.06759, xend = -2.9613, yend = -0.1434+2*0.06759),
col = "black", size = 1) -> plot_patoine
# get the linear regression between rate_of_change and outslope
summary(lm(resample_lm_output500$slope ~ resample_lm_output500$outslope))
plot_patoine +
geom_point(aes(x = patoine_mbc_mat_lm_slope, y = patoine_mean), col = "blue", size = 2) +
geom_segment(aes(x = patoine_mbc_mat_lm_slope, y = patoine_low,
xend = patoine_mbc_mat_lm_slope, yend = patoine_high),
col = "blue", size = 1) +
annotate("text", x = -5, y = -0.6, label = expression("Slope = 0.047, "~R^{2}~" = 0.38, p < 0.01"),
hjust = 0, angle = 0) -> plot_patoine
# add legend
plot_patoine +
geom_segment(aes(x = -2.25, y = -0.45, xend = -1.75, yend = -0.45),
col = "black", size = 1) +
geom_point(aes(x = -2.0, y = -0.45), col = "black", size = 2.5) +
geom_segment(aes(x = -2.25, y = -0.55, xend = -1.75, yend = -0.55),
col = "blue", size = 1) +
geom_point(aes(x = -2.0, y = -0.55), col = "blue", size = 2.5) +
annotate("text", x = -1.5, y = -0.45, label = "Average", col = "black", hjust = 0) +
annotate("text", x = -1.5, y = -0.55, label = "Patoine et al.", col = "blue", hjust = 0) ->
plot_patoine
plot_patoine
plot_patoine / plot_combine
ggsave(here("output/figures", "resample_m500_200_times.png"), width = 7, height = 7)
plot_patoine / plot_combine + plot_annotation(levels = "a")
plot_patoine / plot_combine + plot_annotation(tag_levels = "a")
# ggsave(here("output/figures", "resample_m500_200_times.png"), width = 7, height = 7)
ggsave(here("output/figures", "resample_m500_200_times.png"), width = 7, height = 7)
sub_plot_patoine / sub_plot_combine + plot_annotation(tag_levels = "a")
ggsave(here("output/figures", "resample_m500_200_times_P005.png"), width = 7, height = 7)
plot_patoine_fjoin / plot_combine_fjoin + plot_annotation(tag_levels = "a")
ggsave(here("output/figures", "resample_m500_200_times_fjoin.png"), width = 7, height = 7)
